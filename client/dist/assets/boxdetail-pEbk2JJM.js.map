{"version":3,"file":"boxdetail-pEbk2JJM.js","sources":["../../src/pages/boxdetail.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { useParams, Link, useNavigate } from \"react-router-dom\";\r\nimport { api } from \"../utils/api.js\";\r\n\r\nexport default function BoxDetail() {\r\n  const { id } = useParams();  // serial\r\n  const nav    = useNavigate();\r\n  const [box, setBox] = useState(null);\r\n  const [err, setErr] = useState(\"\");\r\n\r\n  const load = () =>\r\n    api(`/api/boxes/${id}`)\r\n      .then(r=>r.json())\r\n      .then(setBox)\r\n      .catch(()=>setErr(\"Kiste nicht gefunden\"));\r\n  useEffect(load, [id]);\r\n\r\n  if (!box && !err) return <div className=\"p-6\">Lade …</div>;\r\n  if (err)          return <div className=\"p-6 text-error\">{err}</div>;\r\n\r\n  const role = localStorage.getItem(\"role\");\r\n\r\n  const action =\r\n    !box.departed ? {label:\"Auslagern\", api:\"load\", css:\"primary\"} :\r\n    box.departed && !box.returned ? {label:\"Zurücknehmen\", api:\"return\", css:\"accent\"} :\r\n    box.returned && !box.is_checked ? {label:\"Prüfen\", api:\"check\", css:\"info\"} :\r\n    null;\r\n\r\n  const doAction = async () => {\r\n    if (!action) return;\r\n    if (!confirm(`${action.label}?`)) return;\r\n    await api(`/api/boxes/${id}/${action.api}`, { method:\"PUT\" });\r\n    load();\r\n  };\r\n\r\n  const delBox = async () => {\r\n    if (!confirm(\"Kiste endgültig löschen?\")) return;\r\n    await api(`/api/boxes/${id}`, { method:\"DELETE\" });\r\n    nav(\"/boxes\");\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <h1 className=\"text-2xl font-bold\">{box.serial}</h1>\r\n\r\n      <table className=\"table w-auto\">\r\n        <tbody>\r\n          <tr><td>Status</td><td>{box.status}</td></tr>\r\n          <tr><td>Cycles</td><td>{box.cycles}</td></tr>\r\n          <tr><td>Device</td><td>{box.deviceSerial || \"—\"}</td></tr>\r\n          <tr><td>Departed</td><td>{String(box.departed)}</td></tr>\r\n          <tr><td>Returned</td><td>{String(box.returned)}</td></tr>\r\n          <tr><td>Checked</td><td>{box.is_checked ? \"✅\" : \"—\"}</td></tr>\r\n        </tbody>\r\n      </table>\r\n\r\n      {action && (\r\n        <button onClick={doAction} className={`btn btn-${action.css}`}>\r\n          {action.label}\r\n        </button>\r\n      )}\r\n\r\n      <Link to={`/box/${box.serial}/history`} className=\"btn\">History</Link>\r\n\r\n      {role === \"admin\" && (\r\n        <button onClick={delBox} className=\"btn btn-error\">Löschen</button>\r\n      )}\r\n\r\n      <Link to=\"/boxes\" className=\"link block mt-4\">← Zurück</Link>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["BoxDetail","id","useParams","nav","useNavigate","box","setBox","useState","err","setErr","load","api","r","useEffect","jsx","role","action","doAction","delBox","jsxs","Link"],"mappings":"qGAIA,SAAwBA,GAAY,CAClC,KAAM,CAAE,GAAAC,CAAA,EAAOC,EAAA,EACTC,EAASC,EAAA,EACT,CAACC,EAAKC,CAAM,EAAIC,EAAAA,SAAS,IAAI,EAC7B,CAACC,EAAKC,CAAM,EAAIF,EAAAA,SAAS,EAAE,EAE3BG,EAAO,IACXC,EAAI,cAAcV,CAAE,EAAE,EACnB,KAAKW,GAAGA,EAAE,MAAM,EAChB,KAAKN,CAAM,EACX,MAAM,IAAIG,EAAO,sBAAsB,CAAC,EAG7C,GAFAI,YAAUH,EAAM,CAACT,CAAE,CAAC,EAEhB,CAACI,GAAO,CAACG,SAAYM,EAAAA,IAAC,MAAA,CAAI,UAAU,MAAM,SAAA,QAAA,CAAM,EACpD,GAAIN,EAAc,OAAOM,EAAAA,IAAC,MAAA,CAAI,UAAU,iBAAkB,SAAAN,EAAI,EAE9D,MAAMO,EAAO,aAAa,QAAQ,MAAM,EAElCC,EACHX,EAAI,SACLA,EAAI,UAAY,CAACA,EAAI,SAAW,CAAC,MAAM,eAAgB,IAAI,SAAU,IAAI,QAAA,EACzEA,EAAI,UAAY,CAACA,EAAI,WAAa,CAAC,MAAM,SAAU,IAAI,QAAS,IAAI,QACpE,KAHgB,CAAC,MAAM,YAAa,IAAI,OAAQ,IAAI,WAKhDY,EAAW,SAAY,CACtBD,GACA,QAAQ,GAAGA,EAAO,KAAK,GAAG,IAC/B,MAAML,EAAI,cAAcV,CAAE,IAAIe,EAAO,GAAG,GAAI,CAAE,OAAO,KAAA,CAAO,EAC5DN,EAAA,EACF,EAEMQ,EAAS,SAAY,CACpB,QAAQ,0BAA0B,IACvC,MAAMP,EAAI,cAAcV,CAAE,GAAI,CAAE,OAAO,SAAU,EACjDE,EAAI,QAAQ,EACd,EAEA,OACEgB,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACb,SAAA,CAAAL,EAAAA,IAAC,KAAA,CAAG,UAAU,qBAAsB,SAAAT,EAAI,OAAO,EAE/CS,MAAC,QAAA,CAAM,UAAU,eACf,gBAAC,QAAA,CACC,SAAA,CAAAK,OAAC,KAAA,CAAG,SAAA,CAAAL,EAAAA,IAAC,MAAG,SAAA,QAAA,CAAM,EAAKA,EAAAA,IAAC,KAAA,CAAI,SAAAT,EAAI,MAAA,CAAO,CAAA,EAAK,SACvC,KAAA,CAAG,SAAA,CAAAS,EAAAA,IAAC,MAAG,SAAA,QAAA,CAAM,EAAKA,EAAAA,IAAC,KAAA,CAAI,SAAAT,EAAI,MAAA,CAAO,CAAA,EAAK,SACvC,KAAA,CAAG,SAAA,CAAAS,EAAAA,IAAC,MAAG,SAAA,QAAA,CAAM,EAAKA,EAAAA,IAAC,KAAA,CAAI,SAAAT,EAAI,cAAgB,GAAA,CAAI,CAAA,EAAK,SACpD,KAAA,CAAG,SAAA,CAAAS,EAAAA,IAAC,MAAG,SAAA,UAAA,CAAQ,EAAKA,EAAAA,IAAC,KAAA,CAAI,SAAA,OAAOT,EAAI,QAAQ,CAAA,CAAE,CAAA,EAAK,SACnD,KAAA,CAAG,SAAA,CAAAS,EAAAA,IAAC,MAAG,SAAA,UAAA,CAAQ,EAAKA,EAAAA,IAAC,KAAA,CAAI,SAAA,OAAOT,EAAI,QAAQ,CAAA,CAAE,CAAA,EAAK,SACnD,KAAA,CAAG,SAAA,CAAAS,EAAAA,IAAC,MAAG,SAAA,SAAA,CAAO,EAAKA,EAAAA,IAAC,KAAA,CAAI,SAAAT,EAAI,WAAa,IAAM,GAAA,CAAI,CAAA,CAAA,CAAK,CAAA,CAAA,CAC3D,CAAA,CACF,EAECW,GACCF,EAAAA,IAAC,SAAA,CAAO,QAASG,EAAU,UAAW,WAAWD,EAAO,GAAG,GACxD,SAAAA,EAAO,KAAA,CACV,EAGFF,EAAAA,IAACM,GAAK,GAAI,QAAQf,EAAI,MAAM,WAAY,UAAU,MAAM,SAAA,SAAA,CAAO,EAE9DU,IAAS,SACRD,MAAC,SAAA,CAAO,QAASI,EAAQ,UAAU,gBAAgB,SAAA,SAAA,CAAO,QAG3DE,EAAA,CAAK,GAAG,SAAS,UAAU,kBAAkB,SAAA,UAAA,CAAQ,CAAA,EACxD,CAEJ"}