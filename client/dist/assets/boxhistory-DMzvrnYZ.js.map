{"version":3,"file":"boxhistory-DMzvrnYZ.js","sources":["../../src/pages/boxhistory.jsx"],"sourcesContent":["/* client/src/pages/boxhistory.jsx */\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, Link } from \"react-router-dom\";\r\n\r\nexport default function BoxHistory() {\r\n  const { id } = useParams();                     // serial\r\n  const [rows, setRows] = useState(null);\r\n  const [box , setBox ] = useState(null);\r\n  const [err , setErr ] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const token = localStorage.getItem(\"token\");\r\n        const hdr   = { Authorization:`Bearer ${token}` };\r\n\r\n        const [bRes, hRes] = await Promise.all([\r\n          fetch(`/api/boxes/${id}`,           { headers: hdr }),\r\n          fetch(`/api/boxes/${id}/history`,   { headers: hdr }),\r\n        ]);\r\n        if (!bRes.ok) throw new Error(\"Box existiert nicht\");\r\n        if (!hRes.ok) throw new Error(\"Keine Historie gefunden\");\r\n\r\n        setBox(await bRes.json());\r\n        setRows(await hRes.json());\r\n      } catch (e) {\r\n        setErr(e.message);\r\n      }\r\n    })();\r\n  }, [id]);\r\n\r\n  if (err)  return <p className=\"p-6 text-error\">{err}</p>;\r\n  if (!box) return <p className=\"p-6\">Lade …</p>;\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <h1 className=\"text-2xl font-bold\">\r\n        Verlauf – {box.serial} <span className=\"opacity-60\">{box.type}</span>\r\n      </h1>\r\n\r\n      {rows?.length === 0 && <p>Noch keine Historie.</p>}\r\n\r\n      {rows?.length > 0 && (\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr><th>Datum</th><th>Aktion</th><th>Bemerkung</th></tr>\r\n          </thead>\r\n          <tbody>\r\n            {rows.map(ev => (\r\n              <tr key={ev.id}>\r\n                <td>{new Date(ev.timestamp).toLocaleString()}</td>\r\n                <td>\r\n                  <span className={`badge badge-${color(ev.action)}`}>\r\n                    {ev.action}\r\n                  </span>\r\n                </td>\r\n                <td>{ev.comment || \"—\"}</td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      )}\r\n\r\n      <Link to={`/box/${box.serial}`} className=\"link block mt-4\">← zurück</Link>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction color(a) {\r\n  switch (a) {\r\n    case \"load\":   return \"primary\";\r\n    case \"return\": return \"accent\";\r\n    case \"check\":  return \"success\";\r\n    default:       return \"neutral\";\r\n  }\r\n}\r\n"],"names":["BoxHistory","id","useParams","rows","setRows","useState","box","setBox","err","setErr","useEffect","hdr","bRes","hRes","e","jsx","jsxs","ev","color","Link","a"],"mappings":"6DAIA,SAAwBA,GAAa,CACnC,KAAM,CAAE,GAAAC,CAAA,EAAOC,EAAA,EACT,CAACC,EAAMC,CAAO,EAAIC,EAAAA,SAAS,IAAI,EAC/B,CAACC,EAAMC,CAAO,EAAIF,EAAAA,SAAS,IAAI,EAC/B,CAACG,EAAMC,CAAO,EAAIJ,EAAAA,SAAS,EAAE,EAuBnC,OArBAK,EAAAA,UAAU,IAAM,EACb,SAAY,CACX,GAAI,CAEF,MAAMC,EAAQ,CAAE,cAAc,UADhB,aAAa,QAAQ,OAAO,CACG,EAAA,EAEvC,CAACC,EAAMC,CAAI,EAAI,MAAM,QAAQ,IAAI,CACrC,MAAM,cAAcZ,CAAE,GAAc,CAAE,QAASU,EAAK,EACpD,MAAM,cAAcV,CAAE,WAAc,CAAE,QAASU,EAAK,CAAA,CACrD,EACD,GAAI,CAACC,EAAK,GAAI,MAAM,IAAI,MAAM,qBAAqB,EACnD,GAAI,CAACC,EAAK,GAAI,MAAM,IAAI,MAAM,yBAAyB,EAEvDN,EAAO,MAAMK,EAAK,MAAM,EACxBR,EAAQ,MAAMS,EAAK,MAAM,CAC3B,OAASC,EAAG,CACVL,EAAOK,EAAE,OAAO,CAClB,CACF,GAAA,CACF,EAAG,CAACb,CAAE,CAAC,EAEHO,EAAaO,EAAAA,IAAC,IAAA,CAAE,UAAU,iBAAkB,SAAAP,EAAI,EAC/CF,EAGHU,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACb,SAAA,CAAAA,EAAAA,KAAC,KAAA,CAAG,UAAU,qBAAqB,SAAA,CAAA,aACtBV,EAAI,OAAO,IAACS,EAAAA,IAAC,OAAA,CAAK,UAAU,aAAc,WAAI,IAAA,CAAK,CAAA,EAChE,GAECZ,GAAA,YAAAA,EAAM,UAAW,GAAKY,EAAAA,IAAC,KAAE,SAAA,uBAAoB,GAE7CZ,GAAA,YAAAA,EAAM,QAAS,GACda,EAAAA,KAAC,QAAA,CAAM,UAAU,QACf,SAAA,CAAAD,EAAAA,IAAC,QAAA,CACC,gBAAC,KAAA,CAAG,SAAA,CAAAA,EAAAA,IAAC,MAAG,SAAA,OAAA,CAAK,EAAKA,EAAAA,IAAC,MAAG,SAAA,QAAA,CAAM,EAAKA,EAAAA,IAAC,MAAG,SAAA,WAAA,CAAS,CAAA,CAAA,CAAK,CAAA,CACrD,QACC,QAAA,CACE,SAAAZ,EAAK,IAAIc,UACP,KAAA,CACC,SAAA,CAAAF,MAAC,MAAI,SAAA,IAAI,KAAKE,EAAG,SAAS,EAAE,iBAAiB,EAC7CF,EAAAA,IAAC,KAAA,CACC,SAAAA,EAAAA,IAAC,OAAA,CAAK,UAAW,eAAeG,EAAMD,EAAG,MAAM,CAAC,GAC7C,SAAAA,EAAG,OACN,EACF,EACAF,EAAAA,IAAC,KAAA,CAAI,SAAAE,EAAG,SAAW,GAAA,CAAI,CAAA,GAPhBA,EAAG,EAQZ,CACD,CAAA,CACH,CAAA,EACF,EAGFF,EAAAA,IAACI,GAAK,GAAI,QAAQb,EAAI,MAAM,GAAI,UAAU,kBAAkB,SAAA,UAAA,CAAQ,CAAA,EACtE,QAhCgB,IAAA,CAAE,UAAU,MAAM,SAAA,SAAM,CAkC5C,CAEA,SAASY,EAAME,EAAG,CAChB,OAAQA,EAAA,CACN,IAAK,OAAU,MAAO,UACtB,IAAK,SAAU,MAAO,SACtB,IAAK,QAAU,MAAO,UACtB,QAAe,MAAO,SAAA,CAE1B"}