{"version":3,"file":"usermanagement-CBr3dajE.js","sources":["../../src/pages/usermanagement.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { api } from \"../utils/api.js\";\r\n\r\nexport default function UserManagement() {\r\n  const [list, setList] = useState([]);\r\n  const [form, setForm] = useState({ username:\"\", password:\"\", role:\"user\" });\r\n  const [err , setErr ] = useState(\"\");\r\n\r\n  const load = () =>\r\n    api(\"/api/admin/users\")\r\n      .then(r => r.json())\r\n      .then(setList)\r\n      .catch(() => setErr(\"Konnte Userliste nicht laden\"));\r\n  useEffect(load, []);\r\n\r\n  async function create(e) {\r\n    e.preventDefault();\r\n    await api(\"/api/admin/users\", {\r\n      method:\"POST\",\r\n      headers:{ \"Content-Type\":\"application/json\" },\r\n      body: JSON.stringify({\r\n        username: form.username,\r\n        password: form.password || \"changeme\",\r\n        role:     form.role,\r\n      }),\r\n    });\r\n    setForm({ username:\"\", password:\"\", role:\"user\" });\r\n    load();\r\n  }\r\n\r\n  const resetPw = id =>\r\n    confirm(\"PW auf 'changeme' setzen?\") &&\r\n      api(`/api/admin/users/${id}/reset`, { method:\"PUT\" }).then(load);\r\n\r\n  const toggleRole = (id, cur) =>\r\n    api(`/api/admin/users/${id}`, {\r\n      method:\"PUT\",\r\n      headers:{ \"Content-Type\":\"application/json\" },\r\n      body: JSON.stringify({ role: cur === \"admin\" ? \"user\" : \"admin\" }),\r\n    }).then(load);\r\n\r\n  const delUser = id =>\r\n    confirm(\"User wirklich löschen?\") &&\r\n      api(`/api/admin/users/${id}`, { method:\"DELETE\" }).then(load);\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <h1 className=\"text-2xl font-bold\">Benutzerverwaltung</h1>\r\n\r\n      <form onSubmit={create} className=\"card bg-base-100 p-4 max-w-md space-y-4\">\r\n        <h2 className=\"font-semibold\">Neuer Benutzer</h2>\r\n\r\n        <input\r\n          name=\"username\" id=\"username\"\r\n          className=\"input input-bordered w-full\"\r\n          placeholder=\"Username\"\r\n          value={form.username}\r\n          onChange={e=>setForm({...form, username:e.target.value})}\r\n          required\r\n        />\r\n\r\n        <input\r\n          name=\"password\" id=\"password\"\r\n          className=\"input input-bordered w-full\"\r\n          placeholder=\"Passwort (optional)\"\r\n          type=\"password\"\r\n          value={form.password}\r\n          onChange={e=>setForm({...form, password:e.target.value})}\r\n        />\r\n\r\n        <select\r\n          name=\"role\" id=\"role\"\r\n          className=\"select select-bordered w-full\"\r\n          value={form.role}\r\n          onChange={e=>setForm({...form, role:e.target.value})}\r\n        >\r\n          <option value=\"user\">user</option>\r\n          <option value=\"admin\">admin</option>\r\n        </select>\r\n\r\n        <button className=\"btn btn-primary w-full\">Anlegen</button>\r\n      </form>\r\n\r\n      {err && <p className=\"text-error\">{err}</p>}\r\n\r\n      <table className=\"table\">\r\n        <thead>\r\n          <tr><th>User</th><th>Rolle</th><th>Aktionen</th></tr>\r\n        </thead>\r\n        <tbody>\r\n          {list.map(u => (\r\n            <tr key={u.id}>\r\n              <td>{u.username}</td>\r\n              <td>{u.role}</td>\r\n              <td className=\"flex gap-2\">\r\n                <button onClick={()=>toggleRole(u.id,u.role)} className=\"btn btn-xs\">Rolle ↺</button>\r\n                <button onClick={()=>resetPw(u.id)} className=\"btn btn-xs\">PW-Reset</button>\r\n                <button onClick={()=>delUser(u.id)} className=\"btn btn-error btn-xs\">✕</button>\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["UserManagement","list","setList","useState","form","setForm","err","setErr","load","api","r","useEffect","create","e","resetPw","id","toggleRole","cur","delUser","jsxs","jsx","u"],"mappings":"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"}