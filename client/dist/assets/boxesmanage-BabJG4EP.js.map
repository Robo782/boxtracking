{"version":3,"file":"boxesmanage-BabJG4EP.js","sources":["../../src/pages/boxesmanage.jsx"],"sourcesContent":["import { useEffect, useState, useMemo } from \"react\";\r\nimport { api } from \"../utils/api.js\";\r\n\r\nexport default function BoxesManage() {\r\n  const [boxes, setBoxes] = useState([]);\r\n  const [sel  , setSel  ] = useState(new Set());\r\n  const [statF, setStatF] = useState(\"all\");\r\n  const [typeF, setTypeF] = useState(\"all\");\r\n\r\n  const load = () =>\r\n    api(\"/api/boxes\")\r\n      .then(r=>r.json())\r\n      .then(setBoxes);\r\n  useEffect(load, []);\r\n\r\n  const list = useMemo(() => boxes.filter(b =>\r\n    (statF===\"all\" || b.status===statF) &&\r\n    (typeF===\"all\" || b.type  ===typeF)\r\n  ), [boxes, statF, typeF]);\r\n\r\n  const toggle = (id) => {\r\n    const s = new Set(sel);\r\n    s.has(id) ? s.delete(id) : s.add(id);\r\n    setSel(s);\r\n  };\r\n\r\n  const bulk = async (action) => {\r\n    if (!sel.size) return alert(\"Keine Box ausgewählt.\");\r\n    await api(\"/api/admin/boxes/bulk\", {\r\n      method:\"PUT\",\r\n      headers:{ \"Content-Type\":\"application/json\" },\r\n      body: JSON.stringify({ ids:[...sel], action }),\r\n    });\r\n    setSel(new Set());\r\n    load();\r\n  };\r\n\r\n  const allSel = list.length>0 && list.every(b=>sel.has(b.id));\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-4\">\r\n      <h1 className=\"text-2xl font-bold\">Box-Pflege</h1>\r\n\r\n      <div className=\"flex gap-4 flex-wrap items-center\">\r\n        <select className=\"select select-bordered\" value={statF} onChange={e=>setStatF(e.target.value)}>\r\n          <option value=\"all\">Status: Alle</option>\r\n          <option value=\"available\">Verfügbar</option>\r\n          <option value=\"onTour\">Unterwegs</option>\r\n          <option value=\"return\">Rücklauf</option>\r\n          <option value=\"checked\">Geprüft</option>\r\n        </select>\r\n        <select className=\"select select-bordered\" value={typeF} onChange={e=>setTypeF(e.target.value)}>\r\n          <option value=\"all\">Typ: Alle</option>\r\n          <option value=\"PU-S\">PU-S</option>\r\n          <option value=\"PU-M\">PU-M</option>\r\n          <option value=\"PR-M\">PR-M</option>\r\n        </select>\r\n        <span>{sel.size} ausgewählt</span>\r\n      </div>\r\n\r\n      <div className=\"flex gap-2 flex-wrap\">\r\n        <button onClick={()=>bulk(\"load\")}   className=\"btn btn-sm btn-primary\">Auslagern</button>\r\n        <button onClick={()=>bulk(\"return\")} className=\"btn btn-sm btn-accent\">Zurücknehmen</button>\r\n        <button onClick={()=>bulk(\"check\")}  className=\"btn btn-sm btn-info\">Prüfen</button>\r\n        <button onClick={()=>bulk(\"reset\")}  className=\"btn btn-sm\">Reset</button>\r\n      </div>\r\n\r\n      <table className=\"table\">\r\n        <thead>\r\n          <tr>\r\n            <th>\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={allSel}\r\n                onChange={()=>setSel(allSel?new Set():new Set(list.map(b=>b.id)))}\r\n              />\r\n            </th>\r\n            <th>Serial</th><th>Typ</th><th>Status</th><th>Cycles</th><th>Device</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {list.map(b=>(\r\n            <tr key={b.id}>\r\n              <td><input type=\"checkbox\" checked={sel.has(b.id)} onChange={()=>toggle(b.id)} /></td>\r\n              <td>{b.serial}</td>\r\n              <td>{b.type}</td>\r\n              <td>{b.status}</td>\r\n              <td>{b.cycles}</td>\r\n              <td>{b.deviceSerial || \"—\"}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["BoxesManage","boxes","setBoxes","useState","sel","setSel","statF","setStatF","typeF","setTypeF","load","api","r","useEffect","list","useMemo","b","toggle","id","s","bulk","action","allSel","jsxs","jsx","e"],"mappings":"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"}